#summary How to install and configure BabelAS2.

= Introduction =

This guide gives you a exhaustive step-by-step procedure for installing and configuring *BabelAS2*.


= Installation =

This installation procedure have been tested with the following operation systems:
 * Windows XP with IIS V5.1
 * Windows 2003 Server with IIS V6.0

*Unzip BabelAS2.vN.MM.zip in a folder `<`Install`>`.*

*Install CAPICOM:*
 # Copy "`<`Install`>`\BabelAS2\tags\vN.MM\Setup\capicom.dll" to "C:\WINDOWS\system32"
 # Click on Start/Programs/Accessories/Command Prompt
 # Type "C:"
 # Type "cd C:\WINDOWS\system32"
 # Type "regsvr32.exe capicom.dll"
 # Click on the "OK" button.
 # Type "exit"

*Install the test certificate(s) and private key(s):*
 # Double-click on "`<`Install`>`\BabelAS2\tags\vN.MM\Setup\BabelAS2.msc"
 # Expand the "Certificates (Local Computer)" node
 # Right-click on "Personal" and select "All Tasks/Import..."
 # Click on the "Next" button.
 # Click on the "Browse..." button
 # Select "Personal Information Exchange (`*`.pfx;`*`.p12)" in the "Files of type:" drop-down list
 # Select "`<`Install`>`\BabelAS2\tags\vN.MM\Cert\BabelAS2`_`Test`_`Client.pfx"
 # Click on the "Open" button
 # Click on the "Next" button
 # Type "test" in the "Password:" edit box
 # Check "Mark this key as exportable. This will allow you to back up or transport your keys at a later time."
 # Click on the "Next" button.
 # Click on the "Next" button.
 # Click on the "Finish" button.
 # Click on the "OK" button.
 # Repeat from step *3*, with selecting "`<`Install`>`\BabelAS2\tags\vN.MM\Cert\BabelAS2`_`Test`_`Server.pfx" at step *7*.

*_Remark:_* If you only send messages, you can import "`<`Install`>`\BabelAS2\tags\vN.MM\Cert\BabelAS2`_`Test`_`Server.*cer*" instead. And, if you only want to receive, you can import "`<`Install`>`\BabelAS2\tags\vN.MM\Cert\BabelAS2`_`Test`_`Client.*cer*".

*Send a test message to the _BabelAS2 Test Server_:*
 # Double-click on "`<`Install`>`\BabelAS2\tags\vN.MM\Send.vbs"
 # Click on the "OK" button
 # Go to [http://babelas2.babelabout.net/Test/] to check if your test message has arrived
 # Report any problem (or success) to [mailto:babelabout@gmail.com] ;-)

*Create the BabelAS2 user:*
 # Double-click on "`<`Install`>`\BabelAS2\tags\vN.MM\Setup\BabelAS2.msc" (if needed)
 # Expand the "Local User and Groups (Local)" node
 # Right-click on "Users" and select "New User..."
 # Type "BabelAS2" in the "User name:" edit box
 # Type "BabelAS2" in the "Full name:" edit box
 # Type "BabelAS2" in the "Description:" edit box
 # Type "`<`Password`>`" in the "Password:" edit box
 # Type "`<`Password`>`" in the "Confirm password:" edit box
 # Uncheck "User must change password at next logon"
 # Check "User cannot change password"
 # Check "Password never expires"
 # Leave unchecked "Account is disabled"
 # Click on the "Create" button.
 # Click on the "Close" button.
 # Double-click on "BabelAS2" on the right pane
 # Click on the "Member Of" tab
 # Select the "Users" item
 # Click on the "Remove" button
 # Click on the "OK" button.

In order to receive messages, we recommend that you create a dedicated web site on a Windows 2003 server, but you can also just create a virtual directory on a Windows XP machine, see below.

*Create the babelas2.domain.net web site (Windows 2003 only):*
 # Expand the "Internet Information Services" node
 # Expand the "`<`Computer`>` (local computer)" node
 # Right-click on "Web Sites" and select "New/Web Site..." (not available on Windows XP)
 # Click on the "Next" button
 # Type "babelas2.domain.net" in the "Description:" edit box
 # Click on the "Next" button
 # Type "babelas2.domain.net" in the "Host header for this Web site (Default: None):" edit box
 # Click on the "Next" button
 # Click on the "Browse..." button
 # Select "`<`Install`>`\BabelAS2\tags\vN.MM\Receive"
 # Click on the "OK" button
 # Check "Allow anonymous access to this Web site
 # Click on the "Next" button
 # Check "Read"
 # Check "Run scripts (such as ASP)
 # Uncheck "Execute (such as ISAPI applications or CGI)
 # Uncheck "Write"
 # Uncheck "Browse"
 # Click on the "Next" button
 # Click on the "Finish" button
 # Right-click on "babelas2.domain.net" and select "Properties"
 # Click on the "Home Directory" tab
 # Click on the "Configuration..." button
 # Click on the "Options" tab
 # Check "Enable session state"
 # Check "Enable buffering"
 # Check "Enable parent paths"
 # Click on the "OK" button
 # Click on the "Documents" tab
 # Click on the "Add..." button
 # Type "Receive.asp" in the "Default content page:" edit box
 # Click on the "OK" button
 # Click on the "Directory Security" tab
 # Click on the "Edit..." button of the "Authentication and access control" section
 # Check "Enable anonymous access"
 # Click on the "Browse..." button
 # Type "BabelAS2" in the "Enter the object names to select (examples):" text box
 # Click on the "Check Names" button
 # Click on the "OK" button
 # Type "`<`Password`>`" in the "Password:" edit box
 # Uncheck "Integrated Windows authentication"
 # Uncheck "Digest authentication for Windows domain servers"
 # Uncheck "Basic authentication (password is sent in clear text)
 # Uncheck ".NET Passport authentication"
 # Click on the "OK" button
 # Type "`<`Password`>`" in the "Please re-enter the password to confirm:" edit box
 # Click on the "OK" button
 # Click on the "OK" button
 # Click on Start/Programs/Accessories/Windows Explorer
 # Select "`<`Install`>`\BabelAS2\tags\vN.MM\Data"
 # Right-click on "Data" and select "Properties"
 # Click on the "Security" tab
 # Click on the "Add..." button
 # Type "BabelAS2" in the "Enter the object names to select (examples):" text box
 # Click on the "Check Names" button
 # Click on the "OK" button
 # Check "Full Control" in the "Allow" column
 # Click on the "OK" button
 # Click on Start/Programs/Accessories/Command Prompt
 # Type "C:"
 # Type "cd `<`Install`>`\BabelAS2\tags\vN.MM\Setup"
 # Type "winhttpcertcfg -g -c LOCAL_MACHINE\My -s "BabelAS2 Test Server" -a BabelAS2"
 # Type "exit".

*Create the BabelAS2 virtual directory (Windows XP):*
 # Expand the "Internet Information Services" node
 # Expand the "`<`Computer`>` (local computer)" node
 # Expand the "Web Sites" node
 # Right-click on "Default Web Sites" and select "New/Virtual Directory..."
 # Click on the "Next" button
 # Type "BabelAS2" in the "Alias:" edit box
 # Click on the "Next" button
 # Click on the "Browse..." button
 # Select "`<`Install`>`\BabelAS2\tags\vN.MM\Receive"
 # Click on the "OK" button
 # Click on the "Next" button
 # Check "Read"
 # Check "Run scripts (such as ASP)
 # Uncheck "Execute (such as ISAPI applications or CGI)
 # Uncheck "Write"
 # Uncheck "Browse"
 # Click on the "Next" button
 # Click on the "Finish" button
 # Expand the "Default Web Sites" node
 # Right-click on "BabelAS2" and select "Properties"
 # Click on the "Configuration..." button
 # Click on the "Options" tab
 # Check "Enable session state"
 # Check "Enable buffering"
 # Check "Enable parent paths"
 # Click on the "OK" button
 # Click on the "Directory Security" tab
 # Click on the "Edit..." button of the "Anonymous access and authentication control" section
 # Check "Anonymous access"
 # Click on the "Browse..." button
 # Type "BabelAS2" in the "Enter the object names to select (examples):" text box
 # Click on the "Check Names" button
 # Click on the "OK" button
 # Uncheck "Allow IIS to control password"
 # Type "`<`Password`>`" in the "Password:" edit box
 # Uncheck "Digest authentication for Windows domain servers"
 # Uncheck "Basic authentication (password is sent in clear text)
 # Uncheck "Integrated Windows authentication"
 # Click on the "OK" button
 # Type "`<`Password`>`" in the "Please re-enter the password to confirm:" edit box
 # Click on the "OK" button
 # Click on the "OK" button
 # Click on Start/Programs/Accessories/Windows Explorer
 # Select "`<`Install`>`\BabelAS2\tags\vN.MM\Data"
 # Right-click on "Data" and select "Properties"
 # Click on the "Security" tab
 # Click on the "Add..." button
 # Type "BabelAS2" in the "Enter the object names to select (examples):" text box
 # Click on the "Check Names" button
 # Click on the "OK" button
 # Check "Full Control" in the "Allow" column
 # Click on the "OK" button
 # Click on Start/Programs/Accessories/Command Prompt
 # Type "C:"
 # Type "cd `<`Install`>`\BabelAS2\tags\vN.MM\Setup"
 # Type "winhttpcertcfg -g -c LOCAL_MACHINE\My -s "BabelAS2 Test Server" -a BabelAS2"
 # Type "exit".

*Send a test message to your BabelAS2 server:*
 # Click on Start/Programs/Accessories/Windows Explorer
 # Select "`<`Install`>`\BabelAS2\tags\vN.MM\Send.vbs"
 # Right-click on "Send.vbs" and select "Edit"
 # Go to the line 21 and replace "http://babelas2.babelabout.net/" by "babelas2.domain.net" (Windows 2003) or "http://localhost/BabelAS2/Receive.asp" (Windows XP)
 # Click on "File/Save"
 # Click on "File/Exit"
 # Double-click on "`<`Install`>`\BabelAS2\tags\vN.MM\Send.vbs"
 # Click on the "OK" button
 # Go to "`<`Install`>`\BabelAS2\tags\vN.MM\Data to check if your test message has arrived
 # Report any problem (or success) to [mailto:babelabout@gmail.com] ;-)